<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Democratic Primary Predictions</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <!-- Local CSS -->
    <link rel="stylesheet" href="../static/css/style.css">


  </head>
  <body>

<div class="container-lg">

  <!-- Jumbo -->
  <div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12">
      <div class="jumbotron jumbo_text">
        <h1 class="display-3" style='font-weight: 400;'>Primary Predictions</h1>
        <p class="lead">Using machine learning to predict the outcome of the 2020 democratic primaries by county.</p>
        <hr class="my-4">
        <p>Created by Terra Thompson & John Loper</p>
        <p class="lead">
          <a class="btn btn-primary btn-lg" href="https://github.com/JayTDawgzone/democratic_primary_predictions" role="button">View Github</a>
        </p>
      </div>
    </div>
  </div>
  <!-- End Jumbo -->

  <!-- Introduction Text -->
  <div class="row">
    <div class="col-md-8">
      <div style='margin: 2rem;'>
        <p>Using a random forest classifier model, we predicted whether Democratic 2020 candidates Bernie Sanders and Joe Biden would win or lose on the county level.</p>
        <p>A few notes: 
          <ul>
              <li>The model uses the results up to and including Super Tuesday (18 states)</li>
              <li>Predictions are based on classification, so the candidate either wins or loses counties</li>
              <li>We predict the candidates separately, so they can both win or lose the same county</li>
              <li>We did not predict states that were used in the model</li>
          </ul>
        </p>
      </div>
    </div>
  </div>
  <div class="row justify-content-center" style='margin-top: 2rem; margin-bottom: 2rem;'>
    <div class="col-md-5">
      <hr class="my-4">
    </div>
  </div>
  <!-- End Introduction Text -->

  <!-- Map and summary chart -->
  <div class="row">
    <div class="col-md-12 pt-2">
      <div id='results' style='margin-left: 2rem;'><h1>Results</h1></div>
      <div class='text-danger' style='margin-left: 2rem;'><p>Select a state to view county-level results.</p></div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div class="col-md-12">
        <div id="container" style="height: 310px; min-width: 310px; max-width: 500px; margin: 0 auto"></div>
      </div>
      <div class="col-md-12">
        <div id="container2" style="height: 310px; min-width: 310px; max-width: 500px; margin: 0 auto"></div>
      </div>
    </div>
    <div class="col-md-6">
      <div id='summaryChart' style="height: 620px"></div>
    </div>
  </div>
  <!-- End Map and summary chart -->

  <!-- Map and summary chart text -->
  <div class="row" style='margin: 3rem;'>
    <div class="col-md-6">
      <p style='margin: 3rem;'>So far, the model has correctly predicted 7 out of 9 states correctly (78% accuracy), however 1 of the incorrectly predicted states was a very close result.</p>
      <p style='margin: 3rem;'><font color="red">Washington </font>was a close election where the final total vote result was Biden 38% vs. Sanders 36%. We predicted that Sanders would win by 29 counties vs. Biden's 10 counties, but the actual results had Sanders at 13 counties vs. Biden's 26. <font color="red">Arizona </font> was held after Biden gained significant momentum and was likely influenced by his large delegate increase from Big Tuesday.</p>    
      <p style='margin: 3rem;'>It's important to emphasize that our model does not take into account county population, and by extension the number of delgates won. In actuality, a candidate may win the state even though they did not win the majority of counties.</p>        
    </div>
    <div class="col-md-6">
      <table class="table" style='color: white;'>
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">State</th>
            <th scope="col">Predicted Winner</th>
            <th scope="col">Actual Winner</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="row">1</th>
            <td>Arizona</td>
            <td>Sanders</td>
            <td style="color: red;">Biden</td>
          </tr>
          <tr>
            <th scope="row">2</th>
            <td>Florida</td>
            <td>Biden</td>
            <td>Biden</td>
          </tr>
          <tr>
            <th scope="row">3</th>
            <td>Idaho</td>
            <td>Biden</td>
            <td>Biden</td>
          </tr>
          <tr>
            <th scope="row">4</th>
            <td>Illinois</td>
            <td>Biden</td>
            <td>Biden</td>
          </tr>
          <tr>
            <th scope="row">5</th>
            <td>Michigan</td>
            <td>Biden</td>
            <td>Biden</td>
          </tr>
          <tr>
            <th scope="row">6</th>
            <td>Mississippi</td>
            <td>Biden</td>
            <td>Biden</td>
          </tr>
          <tr>
            <th scope="row">7</th>
            <td>Missouri</td>
            <td>Biden</td>
            <td>Biden</td>
          </tr>
            <th scope="row">8</th>
            <td>North Dakota</td>
            <td>Sanders</td>
            <td>Sanders</td>
          </tr>
          <th scope="row">9</th>
            <td>Washington</td>
            <td>Sanders</td>
            <td style="color: red;">Biden</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="row justify-content-center">
    <div class="col-md-5">
      <hr class="my-4">
    </div>
  </div>
  <!-- End Map and summary chart text -->

  <!-- Data  -->
  <div class="row" style='margin-top: 3rem;'>
    <div class="col-md-12">
      <div style='margin-left: 2rem;'><h1>Model Data</h1></div>
    </div>
  </div>
  <div class="row" style='margin-top: 2rem; margin-bottom: 3rem;'>
    <div class="col-md-6">
      <div style='margin-left: 2rem;'>
        <p><strong>Candidate Features:</strong></p>
          <ul>
            <li>
              <p>Candidate stances on policies were used for training and were sourced from the <a href='https://www.washingtonpost.com/graphics/politics/policy-2020/'>Washington Post.</a> Only policies where the candidate's differed were used.</p>
            </li>
            <li>
              <p>Non-policy candidate features (e.g. net worth, committee money, etc.) was sourced from various online sources.</p>
            </li>
          </ul>
      </div>
    </div>
    <div class="col-md-6">
      <div style='margin-left: 2rem;'>
        <p><strong>County Features:</strong></p>
          <ul>
            <li>
              <p>Pre-aggregated county demographic data was sourced from <a href='https://www.kaggle.com/benhamner/2016-us-election'>Kaggle.</a></p>
            </li>
            <li>
              <p>County election results were primarily sourced from the <a href='https://www.washingtonpost.com/elections/'>Washington Post</a>, however for some states, Massachusetts for example, <a href='https://apps.npr.org/elections20-primaries/states/MA.html#counties=true&office=P&date=3%2F3%2F2020&party=Dem'>NPR</a> was used.</p>
            </li>
          </ul>
      </div>
    </div>
  </div>
  <div class="row justify-content-center">
    <div class="col-md-5">
      <hr class="my-4">
    </div>
  </div>
  <!-- End Data  -->

  <!-- Features % vote heatmap-->
  <div class="row" style='margin-top: 3rem;'>
    <div class="col-md-12">
      <div style='margin-left: 2rem;'><h1>Features</h1></div>
    </div>
  </div>
  <div class="row" style='margin-top: 2rem;'>
    <div class="col-md-8">
      <div style='margin-left: 2rem;'>
        <p>After calculating the % vote for each candidate, correlations for each county demographic feature were calculated and are shown below.</p>
      </div>
    </div>
  </div>
  <div class="row" style='margin-top: 1rem;'>
    <div class="col-md-8">
      <div style='margin-left: 2rem;'>
        <p>This shows that Biden does very well areas with a high <font color="red">% black population</font>, while Sanders appears to do well in areas with a high <font color="red">% white population</font> and likely urban areas. The most interesting characteristic of these charts is that Biden appears to rely on a few key demographics while Sanders pulls from a much broader demographic.</p>
      </div>
    </div>
  </div>

  <div class="row" style='margin-top: 2rem;'>
    <div class="col-md-6">
      <div id='bernieHeatmap' style='height: 1000px'></div>
    </div>
    <div class="col-md-6">
      <div id='bidenHeatmap' style='height: 1000px'></div>
    </div>
  </div>
  <!-- End Features % vote heatmap-->

  <!-- Feature correlation heatmap -->
  <div class="row" style='margin-top: 2rem;'>
    <div class="col-md-12">
      <div style='margin-left: 2rem;'><h2>Pruning</h2></div>
    </div>
  </div>
  <div class="row" style='margin-top: 2rem;'>
    <div class="col-md-8">
      <div style='margin-left: 2rem;'>
        <p>A correlation heatmap of all the county demographic features was created to identify highly corelated features to remove.</p>
      </div>
    </div>
  </div>
  <div class="row" style='margin-top: 1rem;'>
    <div class="col-md-8">
      <div style='margin-left: 2rem;'>
        <p>A majority of the features removed were related to the % of firms owned by ethnicities and also populations from different years. While more features could have been removed, there was only a slight improvement to the model accuracy after <font color="red">removing 13 features</font> (~2-3% accuracy improvement).</p>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div id='fullFeatHeatmap' style='height: 600px'></div>
    </div>
    <div class="col-md-6">
      <div id='prunedHeatmap' style='height: 600px'></div>
    </div>
  </div>
  <!-- Feature correlation heatmap -->

  <!-- Feature importance -->
  <div class="row" style='margin-top: 2rem;'>
    <div class="col-md-12">
      <div style='margin-left: 2rem;'><h2>Feature Importance</h2></div>
    </div>
  </div>
  <div class="row" style='margin-top: 2rem;'>
    <div class="col-md-6">
      <div style='margin: 2rem;'>
        <p>The importance of each feature used in the model was calculated and shown to the right.</p>
      </div>
      <div style='margin: 2rem;'>
        <p>Not surprisingly, the most important feature is <font color="red">% black population</font>, which is what we saw above for the % vote feature correlation.</p>
      </div>
      <div style='margin: 2rem;'>
        <p>Interestingly, the second most important feature is <font color="red">land area</font> of the county. This suggests that whether or not the county is rural has a large effect on the candidate outcome.</p>
      </div>
      <div style='margin: 2rem;'>
        <p>A few features were removed due to very low importance (% black owned firms and the policy stance on whether to ratify NA trade agreement)</p>
      </div>
      <div style='margin: 2rem;'>
        <p>After feature pruning, we obtained an acceptable model accuracy:</p>
      </div>
      <div style='margin: 3rem;'>
        <img
        src="../static/images/model_stats.PNG"
        alt="Model Stats">
      </div>
    </div>
    <div class="col-md-6">
      <div id="featureImportance" style="height: 1000px;"></div>
    </div>
  </div>
  <div class="row justify-content-center" style='margin-top: 2rem; margin-bottom: 2rem;'>
    <div class="col-md-5">
      <hr class="my-4">
    </div>
  </div>
  <!-- End Feature importance -->

  <!-- Limitations -->
  <div class="row" style='margin-top: 3rem;'>
    <div class="col-md-12">
      <div style='margin-left: 2rem;'><h1>Limitations and Improvements</h1></div>
    </div>
  </div>
  <div class="row" style='margin-top: 2rem;'>
    <div class="col-md-8">
      <div style='margin: 2rem;'>
        <p>A major limitation of this model is that we are not accounting for the momentum candidates gain after gaining delagates. If we were to <font color="red">add the current delagate counts for each candidate</font>, it would likely greatly increase the model accuracy.</p>
      </div>
      <div style='margin: 2rem;'>
        <p>A second major limiation is how we only predict winners on the county level and do not account for the <font color="red">actual number of delgates rewarded</font>. This is a major hurdle because of the different rules for each state.</p>
      </div>
      <div style='margin: 2rem;'>
        <p>Other models were initally explored (tensorflow, xgboost classifier), and while they showed similar or slightly greater model accuracy for the training states, they were not as accurate for actual predictions. This suggests that we are likely <font color="red">overfitting to our training states</font>, which is not surprising considering our small dataset for training (~3600 rows).</p>
      </div>
    </div>
    <div class="col-md-4" style="margin-top: 2rem;">
      <img
      src="../static/images/cartoon.jpg"
      alt="Silly Cartoon" style='max-width: 100%;'>
    </div>
  </div>
  <!-- End Limitation -->



</div>


  



</div>





  </body>
<!-- D3 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.7/d3.min.js"></script>

<!-- Bootstrap -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- Highcharts -->
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://code.highcharts.com/maps/highmaps.js"></script>
<script src="https://code.highcharts.com/maps/modules/data.js"></script>
<script src="https://code.highcharts.com/maps/modules/drilldown.js"></script>
<script src="https://code.highcharts.com/maps/modules/exporting.js"></script>
<script src="https://code.highcharts.com/maps/modules/offline-exporting.js"></script>
<script src="https://code.highcharts.com/mapdata/countries/us/us-all.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/heatmap.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>

<!-- local  -->
<script src="../static/js/index.js"></script>

</html>
